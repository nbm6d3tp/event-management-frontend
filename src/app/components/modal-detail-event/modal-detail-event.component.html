<mat-dialog-content class="mat-typography mh-100 p-0 container">
  @if (data.isError) {
  <div
    class="d-flex justify-content-center align-items-center min-vh-100 w-100 bg-light"
  >
    There is an error!
  </div>
  } @else {
  <div class="position-relative">
    <div class="img-fluid">
      <img
        [src]="data.event.image"
        handleImgError
        style="padding-bottom: -50px"
        class="img-fluid bg-gradient"
        alt="Event image"
      />
    </div>

    <button
      (click)="onClose()"
      style="
        border-width: 0;
        position: absolute;
        top: 20px;
        right: 15px;
        background: none;
      "
    >
      <i style="font-size: 30px" class="bi bi-x text-white"></i>
    </button>

    <div
      style="
        top: 90%;
        padding-top: 10%;
        border-top-right-radius: 10%;
        border-top-left-radius: 10%;
      "
      class="container h-100 position-absolute bg-white p-4"
    >
      <div class="d-flex justify-content-between align-items-center">
        <h1 class="display-4 fw-bolder text-black mb-3">
          {{ data.event.title }}
        </h1>
        <div>
          <button
            *ngIf="user && canDelete(data.event, user)"
            style="
              border-radius: 50%;
              border-width: 0;
              margin-right: 5px;
              width: 40px;
              height: 40px;
            "
            (click)="onDelete()"
          >
            <i class="bi bi-trash text-danger"></i>
          </button>
          <button
            (click)="onEdit()"
            *ngIf="user && canEdit(data.event, user)"
            style="
              border-radius: 50%;
              border-width: 0;
              width: 40px;
              height: 40px;
            "
          >
            <i class="bi bi-pencil text-primary"></i>
          </button>
        </div>
      </div>

      <div class="lead mb-3">
        {{ data.event.description }}
      </div>

      <div class="mb-3" style="display: flex; align-items: center">
        <img
          [src]="data.event.organizer.avatar"
          alt="Organisator vatar"
          class="rounded-circle"
          style="
            height: 50px;
            width: 50px;
            border-radius: 50%;
            margin-right: 15px;
          "
        />
        <div style="display: flex; flex-direction: column">
          <div class="text-secondary">Event organized by</div>
          <div class="fw-bolder">
            {{ data.event.organizer.name }}
          </div>
        </div>
      </div>

      <div class="mb-3" style="display: flex; align-items: center">
        <i
          style="font-size: 20px; margin-right: 10px"
          class="bi bi-calendar2"
        ></i>
        <div class="fw-bolder">
          {{ data.event.start | date : "MMM d, y h:mm a" }}
        </div>
        <i style="font-size: 20px" class="bi bi-dash"></i>
        <div class="fw-bolder">
          {{ data.event.end | date : "MMM d, y h:mm a" }}
        </div>
      </div>
      <div
        *ngIf="data.event.location"
        class="mb-3"
        style="display: flex; align-items: center"
      >
        <i
          style="font-size: 20px; margin-right: 10px"
          class="bi bi-geo-alt"
        ></i>
        <div class="fw-bolder">
          {{ data.event.location.name }}
        </div>
      </div>

      <mat-chip-set aria-label="Selection">
        <mat-chip>{{ data.event.type }}</mat-chip>
        <mat-chip>{{ data.event.typeLocation }}</mat-chip>
      </mat-chip-set>

      <h2 class="display-6 mt-4">Participants</h2>
      <div style="display: flex">
        @for (participant of data.event.participations; track participant.id) {
        <img
          matTooltip="{{ participant.name }}"
          [src]="participant.avatar"
          alt="participantvatar"
          class="rounded-circle"
          style="
            height: 50px;
            width: 50px;
            border-radius: 50%;
            margin-right: 10px;
          "
        />
        }
      </div>

      <h2 *ngIf="data.event.reviews" class="display-6 mt-4">Reviews</h2>
      <div *ngIf="data.event.reviews" class="list-group">
        @for (review of data.event.reviews; track review.id) {
        <div
          class="list-group-item list-group-item-action d-flex align-items-center justify-content-around"
        >
          <div
            class="d-flex flex-column me-3 align-items-center justify-content-between"
          >
            <img
              [src]="review.person.avatar"
              style="
                height: 50px;
                width: 50px;
                border-radius: 50%;
                margin-bottom: 5px;
              "
            />
            <h4 class="mb-1">{{ review.person.name }}</h4>
          </div>
          <div class="d-flex flex-column align-items-start w-75">
            <small>{{ review.date | date : "short" }}</small>
            <p class="mb-1">
              {{ review.comment }}
            </p>
            <app-star-rating [readonly]="true" [rating]="review.rating" />
          </div>
        </div>
        }
      </div>

      <div
        style="display: flex; justify-content: flex-end; margin-top: 20px"
        class="me-2"
      >
        <button
          *ngIf="user && canCancel(data.event, user)"
          type="submit"
          class="btn btn-outline-danger"
          (click)="onCancel()"
        >
          Cancel
        </button>
        <button
          *ngIf="user && canParticipate(data.event, user)"
          type="submit"
          class="btn btn-primary"
          (click)="onParticipate()"
        >
          Participate
        </button>
        <button
          *ngIf="user && canComment(data.event, user)"
          type="submit"
          class="btn btn-info"
          (click)="onComment()"
        >
          Comment
        </button>
      </div>

      <div style="height: 25px"></div>
    </div>
  </div>
  }
</mat-dialog-content>
